#### **动态内存管理**

c99标准里，可以只用变量来的定义数组的长度，但数组一旦创建就无法更改长度。

```c
malloc  free  calloc  realloc //头文件为<stdlib.h>
```

1. void *malloc (size_t size);向系统申请分配size个字节的内存空间，返回一个指向空间的指针（空间中未初始化数据随机）。

   ```c
   int *ptr;
   ptr=malloc(sizeof(int));//void类型可以被分配给任意类型；
   
   ptr=malloc(num*sizeof(int));//这样得到的一定尺寸的空间！！！
   memset(ptr,0,num*sizeof(int));//把申请下来的内存空间全部初始化为0
   ```

   注意：申请的内存位置在**堆**上，不同于栈不会被自动释放直到程序结束。

2. void free(void *ptr);释放的空间必须时上述函数申请建立的。

   ```c
   free （ptr）;//释放ptr对应的内存空间，注意ptr的指向仍然存在，但以变为非法。
   ```

3. void *calloc (n,size);自动申请N x size个内存空间并且初始化为零。（相当于1中的第二段代码）

4. void *realloc (void *ptr , size_t  size);//重新给ptr分配空间，常用空间不够来扩展。

**内存布局规律**

由低地址到高地址：

代码段-数据段-bss段-堆--（未使用内存空间）--栈-命令行参数和环境变量。

1. 代码段存放程序执行代码，程序运行前就已经启动，只读；
2. 数据段已经初始化的全局变量和局部静态变量；
3. bss段存放为初始化的全局变量，自动初始化为零；
4. 堆，malloc等函数优先放在堆上；free灯函数被释放时从堆中被剔除；
5. 栈由系统自动分配，自动释放；栈的生存周期由函数调用开始到函数返回时结束，函数变量之间步相互访问。